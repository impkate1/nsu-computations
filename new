–û—Ç–ª–∏—á–Ω–æ, —è –≤–∏–∂—É –≤–∞—à –∫–æ–¥! –¢–µ–ø–µ—Ä—å –ø–æ–Ω—è–ª –∑–∞–¥–∞—á—É. –í—ã —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–µ ‚Äî —Å–æ–∑–¥–∞–ª–∏ –≤–µ–∫—Ç–æ—Ä x‚ÇÅ —Å —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ–º 1 –∏ -1 –∏ –≤—ã—á–∏—Å–ª–∏–ª–∏ b = A @ x‚ÇÅ.

–ù–æ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –≤ –≤–∞—à–µ–º –∫–æ–¥–µ x‚ÇÅ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω -1 (–Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 1), –∞ –Ω–µ —á–µ—Ä–µ–¥—É—é—â–∏–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏—è. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª—é:

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ —Å —á–µ—Ä–µ–¥—É—é—â–∏–º–∏—Å—è 1 –∏ -1:

```python
import numpy as np
import matplotlib.pyplot as plt


class SeidelSolver:
    def __init__(self, A, b, tol=1e-10, max_iter=1000):
        self.A = np.array(A, dtype=float)
        self.b = np.array(b, dtype=float)
        self.tol = float(tol)
        self.max_iter = int(max_iter)
        self._validate_input()

    def _validate_input(self):
        n, m = self.A.shape
        if n != m:
            raise ValueError("–ú–∞—Ç—Ä–∏—Ü–∞ A –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π.")
        if self.b.shape[0] != n:
            raise ValueError("–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å b –¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–∞–∑–º–µ—Ä–æ–º A.")
        if np.any(np.isclose(np.diag(self.A), 0.0)):
            raise ValueError("–ù–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ A –µ—Å—Ç—å –Ω—É–ª–∏, –º–µ—Ç–æ–¥ –ó–µ–π–¥–µ–ª—è –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º.")
        if self.tol <= 0:
            raise ValueError("tol –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º.")

    def solve(self, x0=None, return_history=False):
        n = self.A.shape[0]
        x = np.zeros(n, dtype=float) if x0 is None else np.array(x0, dtype=float)
        
        # –°–æ–∑–¥–∞–µ–º x1 —Å —á–µ—Ä–µ–¥—É—é—â–∏–º–∏—Å—è 1 –∏ -1
        x1 = np.ones(n)  # –Ω–∞—á–∏–Ω–∞–µ–º —Å –µ–¥–∏–Ω–∏—Ü
        x1[1::2] = -1    # –∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç (–Ω–∞—á–∏–Ω–∞—è —Å –∏–Ω–¥–µ–∫—Å–∞ 1) –¥–µ–ª–∞–µ–º -1
        
        print(f"–ü–µ—Ä–≤—ã–µ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ x1: {x1[:10]}")  # –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

        diff_history = []
        residual_history = []
        diff_x_x1_history = []  # –∏—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É x –∏ x1

        for iteration in range(1, self.max_iter + 1):
            x_prev = x.copy()
            
            # –û–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –ó–µ–π–¥–µ–ª—è
            for i in range(n):
                # –°—É–º–º–∞ –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å—Ç—Ä–æ–∫–∏, –∫—Ä–æ–º–µ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ
                sum1 = np.dot(self.A[i, :i], x[:i])  # —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
                sum2 = np.dot(self.A[i, i+1:], x_prev[i+1:])  # —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
                x[i] = (self.b[i] - sum1 - sum2) / self.A[i, i]

            # –í—ã—á–∏—Å–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏
            iter_diff = np.linalg.norm(x - x_prev, ord=np.inf)
            residual = np.linalg.norm(self.A @ x - self.b, ord=np.inf)
            diff_x_x1 = np.linalg.norm(x - x1, ord=np.inf)  # —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É x –∏ x1
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            diff_history.append(iter_diff)
            residual_history.append(residual)
            diff_x_x1_history.append(diff_x_x1)

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
            if iter_diff < self.tol:
                if return_history:
                    return x, iteration, diff_history, residual_history, diff_x_x1_history
                return x, iteration

        raise RuntimeError(
            f"–ú–µ—Ç–æ–¥ –Ω–µ —Å–æ—à—ë–ª—Å—è –∑–∞ {self.max_iter} –∏—Ç–µ—Ä–∞—Ü–∏–π. "
            f"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å max_iter –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º—É."
        )


def plot_convergence(diff_history, residual_history, diff_x_x1_history):
    iterations = np.arange(1, len(diff_history) + 1)

    plt.figure(figsize=(10, 6))
    plt.plot(iterations, diff_history, label="||x_k - x_(k-1)||_inf", linewidth=2)
    plt.plot(iterations, residual_history, label="||A x_k - b||_inf", linewidth=2)
    plt.plot(iterations, diff_x_x1_history, label="||x_k - x1||_inf", linewidth=2, linestyle='--')
    
    plt.xlabel("–ò—Ç–µ—Ä–∞—Ü–∏—è")
    plt.ylabel("–ó–Ω–∞—á–µ–Ω–∏–µ")
    plt.title("–ú–µ—Ç–æ–¥ –ó–µ–π–¥–µ–ª—è: —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏ —Ä–∞–∑–Ω–∏—Ü–∞ —Å —Ç–æ—á–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º")
    plt.grid(True, which="both", linestyle="--", alpha=0.5)
    plt.yscale('log')
    plt.xscale('log')
    plt.legend()
    plt.tight_layout()
    plt.show()


def build_T(n):
    """–°–æ–∑–¥–∞–µ—Ç —Ç—Ä–µ—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É T —Ä–∞–∑–º–µ—Ä–∞ n√ón"""
    return np.eye(n) - 0.25 * np.eye(n, k=1) - 0.25 * np.eye(n, k=-1)


def build_D(n):
    """–°–æ–∑–¥–∞–µ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É D —Ä–∞–∑–º–µ—Ä–∞ n√ón"""
    return -0.25 * np.eye(n)


def build_A(n):
    """–°—Ç—Ä–æ–∏—Ç –±–ª–æ—á–Ω–æ-—Ç—Ä–µ—Ö–¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É A —Ä–∞–∑–º–µ—Ä–∞ n¬≤√ón¬≤"""
    T = build_T(n)
    D = build_D(n)
    Z = np.zeros((n, n))

    blocks = []
    for i in range(n):
        row = []
        for j in range(n):
            if i == j:
                row.append(T)
            elif abs(i - j) == 1:
                row.append(D)
            else:
                row.append(Z)
        blocks.append(row)

    return np.block(blocks)


if __name__ == "__main__":
    n = 30
    size = n ** 2

    # –°—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É A
    A = build_A(n)
    print(f"–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü—ã A: {A.shape}")
    
    # –°–æ–∑–¥–∞–µ–º —Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ x1 —Å —á–µ—Ä–µ–¥—É—é—â–∏–º–∏—Å—è 1 –∏ -1
    x1 = np.ones(size)
    x1[1::2] = -1  # —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ: –∏–Ω–¥–µ–∫—Å 1,3,5,... -> -1
    
    print(f"–ü–µ—Ä–≤—ã–µ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ x1: {x1[:10]}")
    print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 1: {np.sum(x1 == 1)}")
    print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ -1: {np.sum(x1 == -1)}")
    
    # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å b = A * x1
    b = A @ x1
    print(f"–ù–æ—Ä–º–∞ b: {np.linalg.norm(b)}")

    # –°–æ–∑–¥–∞–µ–º —Ä–µ—à–∞—Ç–µ–ª—å –∏ —Ä–µ—à–∞–µ–º —Å–∏—Å—Ç–µ–º—É
    solver = SeidelSolver(A, b, tol=1e-12, max_iter=5000)
    solution, iters, diff_hist, residual_hist, diff_x1_hist = solver.solve(return_history=True)

    print(f"\n–†–µ—à–µ–Ω–∏–µ —Å–æ—à–ª–æ—Å—å –∑–∞ {iters} –∏—Ç–µ—Ä–∞—Ü–∏–π")
    print(f"–§–∏–Ω–∞–ª—å–Ω–∞—è –Ω–µ–≤—è–∑–∫–∞: {residual_hist[-1]:.2e}")
    print(f"–§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ —Å x1: {diff_x1_hist[-1]:.2e}")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è
    print(f"\n–¢–æ—á–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è:")
    print(f"  –ù–æ—Ä–º–∞ —Ä–∞–∑–Ω–æ—Å—Ç–∏ solution - x1: {np.linalg.norm(solution - x1):.2e}")
    print(f"  –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞: {np.max(np.abs(solution - x1)):.2e}")

    # –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    plot_convergence(diff_hist, residual_hist, diff_x1_hist)
```

–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ x‚ÇÅ —Å —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ–º:
   ```python
   x1 = np.ones(size)
   x1[1::2] = -1  # –∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–æ–π —ç–ª–µ–º–µ–Ω—Ç (–Ω–∞—á–∏–Ω–∞—è —Å –∏–Ω–¥–µ–∫—Å–∞ 1) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è -1
   ```
2. b = A @ x‚ÇÅ ‚Äî –≤—ã —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª–∏:
   ```python
   b = A @ x1
   ```
3. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É x –∏ x‚ÇÅ ‚Äî —Ç–µ–ø–µ—Ä—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏:
   ```python
   diff_x_x1 = np.linalg.norm(x - x1, ord=np.inf)
   ```
4. –ì—Ä–∞—Ñ–∏–∫ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   ¬∑ –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ (—Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏)
   ¬∑ –ù–µ–≤—è–∑–∫—É (||Ax - b||)
   ¬∑ –†–∞–∑–Ω–∏—Ü—É —Å —Ç–æ—á–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º x‚ÇÅ (||x - x‚ÇÅ||)

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

–î–ª—è n=30:

¬∑ –í–µ–∫—Ç–æ—Ä x‚ÇÅ –∏–º–µ–µ—Ç –¥–ª–∏–Ω—É 900
¬∑ –ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ: –ø–æ–∑–∏—Ü–∏–∏ 0,2,4,... = 1; –ø–æ–∑–∏—Ü–∏–∏ 1,3,5,... = -1
¬∑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 1 –∏ -1: –ø–æ 450 –∫–∞–∂–¥–æ–≥–æ (–µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —á–µ—Ç–Ω—ã–π)

–¢–µ–ø–µ—Ä—å –≤—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ —á–∏—Å–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ x –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ —Ç–æ—á–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é x‚ÇÅ —Å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π! üìä
